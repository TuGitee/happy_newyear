<head>
    <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,height=device-height,minimum-scale=1">
    </meta>
    <meta charset="utf-8">
    </meta>
    <meta name="theme-color" content="#000">
    </meta>
    <title>Êñ∞Âπ¥Âø´‰πê</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://unpkg.com/vue-tut-clock@0.1.22/lib/vue-tut-clock.umd.min.js"></script>
    <style>
        * {
            user-select: none;
            margin: 0;
        }

        body,
        html {
            overflow: hidden;
            background-color: #000;
            height: 100vh;
            width: 100vw;
            color-scheme: dark;
        }

        #n {
            position: absolute;
            inset: 0;
            height: 100vh;
            width: 100vw;
        }

        #app {
            pointer-events: none;
        }

        #app .clock-box {
            line-height: 1.8;
            gap: 0.8vmin;
        }

        p.write::after {
            content: "";
            height: 1em;
            width: 0.5em;
            vertical-align: -0.15em;
            margin-left: 0.2em;
            background-color: white;
            display: inline-block;
            animation: write 1s infinite both;
        }

        @keyframes write {
            0% {
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <canvas id="n"></canvas>
    <div id="app">
        <flip-clock :formatter="formatter" deadline="2024/1/1" center size="fit">
            <template #header>
                <h1>Ë∑ùÁ¶ª 2024Âπ¥ ËøòÊúâ</h1>
            </template>
            <template #footer>
                <p>Êñ∞Âπ¥Âø´‰πê üéâ</p>
                <p>ÊÇ®Â∑≤ÁªèËÆøÈóÆ‰∫Ü{{visits}}Ê¨°Âï¶ üéá</p>
                <p class="write">Â∏åÊúõÊÇ®Âú®Êñ∞ÁöÑ‰∏ÄÂπ¥Èáå<span>{{sentences[index].slice(0, current)}}</span></p>
            </template>
        </flip-clock>
    </div>

    <script>
        function setCookie(name, value, expires, path, domain, secure) {
            var curCookie = name + "=" + escape(value) +
                ((expires) ? "; expires=" + expires.toGMTString() : "") +
                ((path) ? "; path=" + path : "") +
                ((domain) ? "; domain=" + domain : "") +
                ((secure) ? "; secure" : "")
            if ((name + "=" + escape(value)).length <= 4000)
                document.cookie = curCookie
            else
                if (confirm("Cookie exceeds 4KB and will be cut!"))
                    document.cookie = curCookie
        }
        function getCookie(name) {
            var prefix = name + "="
            var cookieStartIndex = document.cookie.indexOf(prefix)
            if (cookieStartIndex == -1)
                return null
            var cookieEndIndex = document.cookie.indexOf(";", cookieStartIndex + prefix.length)
            if (cookieEndIndex == -1)
                cookieEndIndex = document.cookie.length
            return unescape(document.cookie.substring(cookieStartIndex + prefix.length, cookieEndIndex))
        }
        function deleteCookie(name, path, domain) {
            if (getCookie(name)) {
                document.cookie = name + "=" +
                    ((path) ? "; path=" + path : "") +
                    ((domain) ? "; domain=" + domain : "") +
                    "; expires=Thu, 01-Jan-70 00:00:01 GMT"
            }
        }
    </script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    visits: 0,
                    sentences: ["ÈæôË°åÈæòÈæò", "‰∏á‰∫ãÂÖ¥‚ÄúÈæô‚Äù", "ÈÄæË∑ÉÈæôÈó®", "‚ÄúÈæô‚ÄùÂÖâÁÑïÂèë", "Ê¨£Ê¨£Âêë‚ÄúÈæô‚Äù", "ÈæôÂπ¥Â§ßÂêâÔºå‰∏á‰∫ãÂ¶ÇÊÑèÔºÅ"],
                    index: 0,
                    current: 0,
                    isWrite: true,
                }
            },
            computed: {
                formatter() {
                    const days = Math.abs(new Date().getTime() - new Date("2024/1/1"))
                    const length = parseInt(days / 1000 / 60 / 60 / 24).toString().length
                    return (length ? '' : 'D'.repeat(length) + 'Â§© ') + 'HHÊó∂IIÂàÜSSÁßí'
                }
            },
            mounted() {
                setInterval(() => {
                    if (this.isWrite && this.current < this.sentences[this.index].length) {
                        this.current++
                    } else if (!this.isWrite && this.current > 0) {
                        this.current--
                    } else if (this.current === this.sentences[this.index].length) {
                        this.isWrite = !this.isWrite
                    } else {
                        this.index = (this.index + 1) % this.sentences.length
                        this.current = 0
                        this.isWrite = !this.isWrite
                    }
                }, 300)


                function fixDate(date) {
                    let base = new Date(0)
                    let skew = base.getTime()
                    if (skew > 0)
                        date.setTime(date.getTime() - skew)
                }
                var now = new Date()
                fixDate(now)
                now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000)
                let visits = getCookie("counter")
                this.visits = visits ? parseInt(visits) + 1 : 1
                setCookie("counter", this.visits, now)
            }
        })
    </script>
</body>

<script>
    document.addEventListener('touchstart', function (event) {
        event.preventDefault()
    })
</script>

<script>
    const getRandom = (min = 0, max = 1) => Math.random() * (max - min) + min;
    let n = document.getElementById("n"), m = n.getContext("2d"), w, h, v = [], p = getRandom(0.02, 0.08), xp, yp;
    window.animationFrame = window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || window.requestAnimationFrame || function (c) { setTimeout(c, 16) };
    init();
    function init() {
        window.addEventListener("resize", resize);
        resize();
        window.animationFrame(draw);
        window.addEventListener('click', fc);
        window.addEventListener('touchstart', fc);
    }
    function resize() {
        if (!!n) {
            w = n.width = window.innerWidth;
            h = n.height = window.innerHeight
        }
    }
    function fc(e) {
        xp = e.pageX;
        yp = e.pageY;
        cf(xp, yp)
    }
    function draw() {
        u();
        d();
        window.animationFrame(draw)
    }
    function u() {
        if (v.length < n.width && getRandom() < p) cf();
        let a = [];
        for (let i = 0; i < v.length; i++) {
            if (v[i].m())
                a.push(v[i])
        }
        v = a
    }
    function d() {
        m.globalCompositeOperation = 'source-over';
        m.fillStyle = "rgba(0,0,0,.2)";
        m.fillRect(0, 0, w, h);
        m.globalCompositeOperation = 'lighter';
        for (let i = 0; i < v.length; i++) {
            v[i].d(m)
        }
    }
    function cf(x, y) {
        xp = x || getRandom() * (w - 200) + 100;
        yp = y || getRandom() * (h - 200) + 100;
        let e = getRandom() * 50 + 100;
        let c = "rgb(" + ~~(getRandom() * 200 + 55) + "," + ~~(getRandom() * 200 + 55) + "," + ~~(getRandom() * 200 + 55) + ")";
        for (let i = 0; i < e; i++) {
            let o = new Pt();
            o.c = c;
            let vy = Math.sqrt(25 - o.vx * o.vx);
            if (Math.abs(o.vy) > vy) {
                o.vy = o.vy > 0 ? vy : -vy
            }
            v.push(o)
        }
    }
    class Pt {
        g = .08;
        constructor() {
            this.w = this.h = getRandom(2, 4);
            this.x = xp - this.w / 2;
            this.y = yp - this.h / 2;
            this.vx = getRandom(-5, 5);
            this.vy = getRandom(-5, 5);
            this.t = getRandom(0.75, 1);
            this.c
        };
        m() {
            this.x += this.vx;
            this.vy += this.g;
            this.y += this.vy;
            this.t -= .01;
            if (this.x <= -this.w || this.x >= n.width || this.y >= n.height || this.t <= 0) return false;
            return true
        };
        d(c) {
            c.save();
            c.beginPath();
            c.translate(this.x + this.w / 2, this.y + this.h / 2);
            c.arc(0, 0, this.w, 0, Math.PI * 2);
            c.fillStyle = this.c;
            c.globalAlpha = this.t;
            c.closePath();
            c.fill()
            c.restore()
        }
    }</script>
