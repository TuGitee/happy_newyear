<head>
    <meta name="viewport" content="width=device-width">
    </meta>
    <title>新年快乐</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://unpkg.com/vue-tut-clock@0.1.22/lib/vue-tut-clock.umd.min.js"></script>
    <style>
        * {
            user-select: none;
            margin: 0
        }

        body {
            overflow: hidden;
            background-color: #2b2b2b;
        }
    </style>
</head>

<body>
    <canvas id="n"></canvas>
    <div id="app">
        <flip-clock :formatter="formatter" deadline="2024/1/1" center size="fit" event="2024年">
        </flip-clock>
    </div>
    <script>
        new Vue({
            el: '#app',
            computed: {
                formatter() {
                    const days = Math.abs(new Date().getTime() - new Date("2024/1/1"))
                    const length = parseInt(days / 1000 / 60 / 60 / 24).toString().length
                    return (length ? '' : 'D'.repeat(length) + '天 ') + 'HH时II分SS秒'
                }
            }
        })
    </script>
</body>

<script>g = window; s = g.addEventListener; j = Math.random; let n, m, w, h, v = [], p = 0.02, xp, yp; g.f = g.webkitRequestAnimationFrame || g.mozRequestAnimationFrame || g.oRequestAnimationFrame || g.msRequestAnimationFrame || function (c) { g.setTimeout(c, 16) }; l(); function l() { n = document.getElementById("n"); s("resize", r); m = n.getContext("2d"); r(); g.f(b); s('click', fc) } function r() { if (!!n) { w = n.width = g.innerWidth; h = n.height = g.innerHeight } } function fc(e) { xp = e.pageX; yp = e.pageY; cf(xp, yp) } function b() { u(); d(); g.f(b) } function u() { if (v.length < n.width && j() < p) cf(); let a = []; for (let i = 0; i < v.length; i++) { if (v[i].m()) a.push(v[i]) } v = a } function d() { m.globalCompositeOperation = 'source-over'; m.fillStyle = "rgba(0,0,0,.2)"; m.fillRect(0, 0, w, h); m.globalCompositeOperation = 'lighter'; for (let i = 0; i < v.length; i++) { v[i].d(m) } } function cf(x, y) { xp = x || j() * (w - 200) + 100; yp = y || j() * (h - 200) + 100; let e = j() * 50 + 100; let c = "rgb(" + ~~(j() * 200 + 55) + "," + ~~(j() * 200 + 55) + "," + ~~(j() * 200 + 55) + ")"; for (let i = 0; i < e; i++) { let o = new Pt(); o.c = c; let vy = Math.sqrt(25 - o.vx * o.vx); if (Math.abs(o.vy) > vy) { o.vy = o.vy > 0 ? vy : -vy } v.push(o) } } class Pt { g = .08; constructor() { this.w = this.h = j() * 4 + 1; this.x = xp - this.w / 2; this.y = yp - this.h / 2; this.vx = (j() - .5) * 10; this.vy = (j() - .5) * 10; this.t = j() * .5 + .5; this.c }; m() { this.x += this.vx; this.vy += this.g; this.y += this.vy; this.t -= .01; if (this.x <= -this.w || this.x >= n.width || this.y >= n.height || this.t <= 0) return false; return true }; d(c) { c.save(); c.beginPath(); c.translate(this.x + this.w / 2, this.y + this.h / 2); c.arc(0, 0, this.w, 0, Math.PI * 2); c.fillStyle = this.c; c.globalAlpha = this.t; c.closePath(); c.fill(); c.restore() } }</script>
